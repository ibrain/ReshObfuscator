<?php error_reporting(E_ALL); function random_string($length = 8){  $chars = 'abdefhiknrstyzABDEFGHKNQRSTYZ';  $numChars = strlen($chars);  $string = '';  for ($i = 0; $i < $length; $i++) {    $string .= substr($chars, rand(1, $numChars) - 1, 1);  }  return $string;}  $my_eval  =  "_".rand(4000,70000); $my_eval_arg = random_string(4); $my_x0v = random_string(6); $my_dmk =random_string(4);   function to_shellcode($m_code) {	$n_code = "";	$n_code = base64_encode($m_code);	/*for($i = 0;$i<strlen($m_code);$i++)	{		$n_code.="\\x".dechex(ord($m_code[$i]));	}*/		return $n_code; }  $mybs4f_name = random_string(4,7); $mw_name = random_string(4,9); $code = urldecode(stripslashes($_POST["mew"])); $code = str_replace("<html>","<script>$mw_name($mybs4f_name(\"".base64_encode("<html>")."\"));</script>",$code); $code = str_replace("</html>","<script>$mw_name($mybs4f_name(\"".base64_encode("</html>")."\"));</script>",$code); $code = str_replace("<body>","<script>$mw_name($mybs4f_name(\"".base64_encode("<body>")."\"));</script>",$code); $code = str_replace("<div","<script>$mw_name($mybs4f_name(\"".base64_encode("<div ")."\"));</script>",$code); $code = str_replace("</div>","<script>$mw_name($mybs4f_name(\"".base64_encode("</div> ")."\"));</script>",$code); $code = str_replace("<input","<script>$mw_name($mybs4f_name(\"".base64_encode("<input ")."\"));</script>",$code); $code = str_replace("<br/>","<script>$mw_name($mybs4f_name(\"".base64_encode("<br/>")."\"));</script>",$code); $code = str_replace("<br>","<script>$mw_name($mybs4f_name(\"".base64_encode("<br>")."\"));</script>",$code); $code = str_replace("</body>","<script>$mw_name($mybs4f_name(\"".base64_encode("</body>")."\"));</script>",$code); $code = str_replace("<body","<script>$mw_name($mybs4f_name(\"".base64_encode("<body")."\"));</script>",$code); $code = str_replace("<a ","<script>$mw_name($mybs4f_name(\"".base64_encode("<a ")."\"));</script>",$code); $code = str_replace("<img ","<script>$mw_name($mybs4f_name(\"".base64_encode("<img ")."\"));</script>",$code); $code = str_replace("<h1 ","<script>$mw_name($mybs4f_name(\"".base64_encode("<h1 ")."\"));</script>",$code); $code = str_replace("<meta ","<script>$mw_name($mybs4f_name(\"".base64_encode("<meta ")."\"));</script>",$code); $code = str_replace("<link ","<script>$mw_name($mybs4f_name(\"".base64_encode("<link ")."\"));</script>",$code); $code = str_replace("<form ","<script>$mw_name($mybs4f_name(\"".base64_encode("<form ")."\"));</script>",$code); $code = str_replace("<textarea ","<script>$mw_name($mybs4f_name(\"".base64_encode("<textarea ")."\"));</script>",$code); $code = str_replace("<iframe ","<script>$mw_name($mybs4f_name(\"".base64_encode("<iframe ")."\"));</script>",$code); $code = str_replace("</iframe> ","<script>$mw_name($mybs4f_name(\"".base64_encode("</iframe>")."\"));</script>",$code);  $code = "<script>function $mw_name(zna){var _0xaca0=[\"\\x77\\x72\\x69\\x74\\x65\"];document[_0xaca0[0]](zna);}</script><script>function $mybs4f_name( data ){var b64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";var o1, o2, o3, h1, h2, h3, h4, bits, i=0, enc='';do { h1 = b64.indexOf(data.charAt(i++));h2 = b64.indexOf(data.charAt(i++));h3 = b64.indexOf(data.charAt(i++));h4 = b64.indexOf(data.charAt(i++));bits = h1<<18 | h2<<12 | h3<<6 | h4;o1 = bits>>16 & 0xff;o2 = bits>>8 & 0xff;o3 = bits & 0xff;if (h3 == 64)	  enc += String.fromCharCode(o1);else if (h4 == 64) enc += String.fromCharCode(o1, o2);else	enc += String.fromCharCode(o1, o2, o3);} while (i < data.length);return enc;}</script>".$code; $code  = "?><p></p>".$code; $code = to_shellcode($code);  function add_trash($code) { $trash="";  /*	$trash = "";		for($i=0;$i<rand(4,7);$i++)	{		switch(rand(1,6))		{			case 2:			{ 				$trash.="\$".random_string(4)."=array(".rand(1092,2088).",";				for($j=0;$j<rand(2,5);$j++)				{					$trash.="\"".base64_encode(rand(2015,7052).random_string())."\",";				}				$trash.=rand(709,10022).");";				break;			}						case 3 : 			{				for($j=0;$j<rand(3,6);$j++)				{				$arg = random_string(4);				$trash.= "function _".rand(1000,20000)."(\$".$arg."){return eval(\$$arg);}";								}				break;						}				case 4: 		{			for($j=0;$j<rand(2,4);$j++)			{			$arg = to_shellcode(random_string(17));			$trash.= "\$".random_string(5)."=\"".$arg."\";";							}				break;		}				case 6:		{			/*for($j=0;$j<rand(2,4);$j++)			{			$arg = to_shellcode(random_string(strlen($code)/4));			$trash.= "\$".random_string(5)."=\"".$arg."\";";							}				break;		}	}		 } */ return $trash; }    $text = "<?php  function $my_eval(\$$my_eval_arg){return eval(\$$my_eval_arg);}".add_trash($code)."\$$my_x0v = \"\\x62\x61\\x73\\x65\\x36\\x34\\x5f\\x64\\x65\\x63\\x6f\\x64\\x65\"; \$$my_dmk =\"\\x70\\x72\\x65\\x67\\x5f\\x72\\x65\\x70\\x6c\\x61\\x63\\x65\"; \$$my_dmk('!!e','$my_eval(\$$my_x0v(\"$code\"));', ''); ?>"; echo($text); ?> 